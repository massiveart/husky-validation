define("form/util",[],function(){var e=["form","validation"];return{debugEnabled:!1,getFields:function(e){return $(e).find('input:not([data-form="false"], [type="submit"], [type="button"]), textarea:not([data-form="false"]), select:not([data-form="false"]), *[data-form="true"]')},parseData:function(e,t,n){var r,i=$(e);return this.buildOptions(i.data(),t,"",n)},buildOptions:function(t,n,r,i){r||(r=""),i||(i={});var s=$.extend({},i,{}),o=n+this.ucFirst(r);return $.each(t,function(t,r){var i=new RegExp("^"+o);i.test(t)&&$.inArray(t,e)==-1&&(t!==o?t=t.replace(i,""):t=t.replace(new RegExp("^"+n),""),t!==""&&(t=this.lcFirst(t),s[t]=r))}.bind(this)),s},debug:function(e,t,n){!this.debugEnabled||(e?t?n?console.log("Husky Validation:",e,t,n):console.log("Husky Validation:",e,t):console.log("Husky Validation:",e):console.log("Husky Validation"))},ucFirst:function(e){e+="";var t=e.charAt(0).toUpperCase();return t+e.substr(1)},lcFirst:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},startsWith:function(e,t){return e.indexOf(t)==0}}}),define("form/element",["form/util"],function(e){return function(t,n){var r={type:"string",validationTrigger:"focusout",validationAddClasses:!0,validationSuccessClass:"husky-validate-success",validationErrorClass:"husky-validate-error",validation:!0},i=["validation","validationTrigger","validationAddClasses","validationSuccessClass","validationErrorClass","validationSubmitEvent"],s,o={},u,a=null,f={initialize:function(){this.$el=$(t),this.$el.data("element",this),this.options=$.extend({},r,n),!this.options.validation||f.initValidation.call(this)},initValidation:function(){f.bindValidationDomEvents.call(this),f.initValidators.call(this),f.initType.call(this)},bindValidationDomEvents:function(){var e=this.options.validationTrigger?this.options.validationTrigger:"";if(e===""||e==="none")return;this.$el.is("select")&&(e+=(new RegExp("change","i")).test(e)?"":" change"),e=e.replace(/^\s+/g,"").replace(/\s+$/g,""),this.$el.bind(e,this.validate.bind(this))},initValidators:function(){$.each(this.options,function(t,n){if(!!n&&$.inArray(t,i)==-1&&e.startsWith(t,"validation")){var r=e.lcFirst(t.replace("validation",""));require(["validator/"+r],function(n){var i=e.buildOptions(this.options,"validation",r);o[r]=new n(this.$el,i),e.debug("Element Validator",t,i)}.bind(this))}}.bind(this))},initType:function(){!this.options.type||require(["type/"+this.options.type],function(t){var n=e.buildOptions(this.options,"type");u=new t(this.$el,n),e.debug("Element Type",u,n)}.bind(this))},hasConstraints:function(){return Object.keys(o).length>0||u!=null&&u.needsValidation()},needsValidation:function(){return a!==this.$el.val()},reset:function(){this.$el.removeClass(this.options.validationSuccessClass),this.$el.removeClass(this.options.validationErrorClass)},setValid:function(e){s=e,!this.options.validationAddClasses||(f.reset.call(this),e?this.$el.addClass(this.options.validationSuccessClass):this.$el.addClass(this.options.validationErrorClass))}},l={validate:function(e){if(e||f.needsValidation.call(this)){if(!f.hasConstraints.call(this))return f.reset.call(this),!0;var t=!0;$.each(o,function(e,n){n.validate()||(t=!1)}),u!=null&&!u.validate()&&(t=!1),f.setValid.call(this,t)}return this.isValid()},isValid:function(){return s},updateConstraint:function(e,t){if(!($.inArray(e,Object.keys(o))>-1))throw"No constraint with name: "+e;o[e].updateConstraint(t),this.validate()},deleteConstraint:function(e){if(!($.inArray(e,Object.keys(o))>-1))throw"No constraint with name: "+e;delete o[e],this.validate(!0)},addConstraint:function(e,t){if($.inArray(e,Object.keys(o))!=-1)throw"Constraint with name: "+e+" already exists";require(["validator/"+e],function(n){o[e]=new n(this.$el,t),this.validate()}.bind(this))},setValue:function(e){u.setValue(e)},getValue:function(e){return u.getValue(e)}};return f.initialize.call(l),l}}),define("form/validation",["form/util"],function(e){return function(t){var n,r={initialize:function(){r.bindValidationDomEvents.call(this),e.debug("INIT Validation")},bindValidationDomEvents:function(){!t.options.validationSubmitEvent||t.$el.on("submit",function(){return t.validation.validate()}.bind(this))},setValid:function(e){n=e}},i={validate:function(n){var i=!0;return $.each(t.elements,function(e,t){t.validate(n)||(i=!1)}),r.setValid.call(this,i),e.debug("Validation",i?"success":"error"),i},isValid:function(){return n},updateConstraint:function(e,t,n){var r=$(e);if(!r.data("element"))throw"No validation element";$(e).data("element").updateConstraint(t,n)},deleteConstraint:function(e,t){var n=$(e);if(!n.data("element"))throw"No validation element";n.data("element").deleteConstraint(t)},addConstraint:function(e,n,r){var i=$(e);if(!i.data("element")){var s=new Element(i,this.options.element);s.addConstraint(n,r),t.elements.push(s)}else i.data("element").addConstraint(n,r)}};return r.initialize.call(i),i}}),define("form/mapper",["form/util"],function(e){return function(t){var n,r={initialize:function(){e.debug("INIT Mapper")},processData:function(e){var n=$(e),r=n.data("type"),i=n.data("element");if(r!=="array")return i.getValue();var s=[];return $.each(n.children(),function(e,n){s.push(t.mapper.getData($(n)))}),s}},i={setData:function(n,r){r||(r=t.$el),$.each(n,function(n,i){var s='*[data-mapper-property="'+n+'"]',o=r.find(s),u=o.data("element");if($.isArray(i)){var a=o.children().first();$.each(e.getFields(o),function(e,n){t.removeField(n)}.bind(this)),o.children().remove(),$.each(i,function(e,n){var r=a.clone();o.append(r),t.mapper.setData(n,r)})}else u?u.setValue(i):(u=t.addField(o),setTimeout(function(){u.setValue(i)},100))}.bind(this))},getData:function(e){e||(e=t.$el);var n={},i="*[data-mapper-property]",s=e.find(i);while(s.length>0){var e=$(s.get(0)),o=e.data("mapper-property");n[o]=r.processData.call(this,e),s=s.not(e),s=s.not(e.find(i))}return n}};return r.initialize.call(i),i}}),require.config({paths:{form:"js/form","form/mapper":"js/mapper","form/validation":"js/validation","form/element":"js/element","form/util":"js/util","type/default":"js/types/default","type/string":"js/types/string","type/date":"js/types/date","type/decimal":"js/types/decimal","type/email":"js/types/email","type/url":"js/types/url","type/label":"js/types/label","validator/default":"js/validators/default","validator/min":"js/validators/min","validator/max":"js/validators/max","validator/minLength":"js/validators/min-length","validator/maxLength":"js/validators/max-length","validator/required":"js/validators/required"}}),define("form",["form/element","form/validation","form/mapper","form/util"],function(e,t,n,r){return function(i,s){var o={debug:!1,validation:!0,validationTrigger:"focusout",validationAddClasses:!0,validationSubmitEvent:!0,mapper:!0},u,a={initialize:function(){this.$el=$(i),this.options=$.extend(o,this.$el.data(),s),r.debugEnabled=this.options.debug,a.initFields.call(this),!this.options.validation||(this.validation=new t(this)),!this.options.mapper||(this.mapper=new n(this)),this.$el.data("form-object",this),r.debug("Form",this),r.debug("Elements",this.elements)},initFields:function(){$.each(r.getFields(this.$el),function(e,t){this.addField.call(this,t)}.bind(this))},bindValidationDomEvents:function(){!this.options.validationSubmitEvent||this.$el.on("submit",function(){return this.validation.validate()}.bind(this))}},f={elements:[],options:{},validation:!1,mapper:!1,addField:function(t){var n=$(t),i=r.parseData(n,"",this.options),s=new e(n,i);return this.elements.push(s),r.debug("Element created",i),s},removeField:function(e){var t=$(e),n=t.data("element");this.elements.splice(this.elements.indexOf(n))}};return a.initialize.call(f),f}}),define("type/default",[],function(){return function(e,t,n,r,i){var s={initialize:function(){this.$el=e,this.options=$.extend({},t,n),!this.initializeSub||this.initializeSub()}},o={name:r,needsValidation:function(){return!0},updateConstraint:function(e){this.options=$.extend({},this.options,e)},setValue:function(e){this.$el.val(this.getViewData.call(this,e))},getValue:function(){return this.getModelData.call(this,this.$el.val())},getViewData:function(e){return e},getModelData:function(e){return e}},u=$.extend({},o,i);return s.initialize.call(u),u}}),define("type/string",["type/default"],function(e){return function(t,n){var r={},i={initializeSub:function(){},needsValidation:function(){return!1},validate:function(){return!0}};return new e(t,r,n,"string",i)}}),define("type/date",["type/default"],function(e){return function(t,n){var r={language:"de",languages:{de:/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/}},i={initializeSub:function(){},validate:function(){return this.options.languages[this.options.language].test(this.$el.val())}};return new e(t,r,n,"date",i)}}),define("type/decimal",["type/default"],function(e){return function(t,n){var r={regExp:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/},i={initializeSub:function(){},validate:function(){return this.options.regExp.test(this.$el.val())}};return new e(t,r,n,"decimal",i)}}),define("type/email",["type/default"],function(e){return function(t,n){var r={regExp:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))){2,6}$/i},i={validate:function(){return this.options.regExp.test(this.$el.val())}};return new e(t,r,n,"email",i)}}),define("type/url",["type/default"],function(e){return function(t,n){var r={regExp:/^(https?|s?ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},i={validate:function(){var e=this.$el.val();return this.data["url-strict"]!=="true"&&(e=(new RegExp("(https?|s?ftp|git)","i")).test(e)?e:"http://"+e),this.options.regExp.test(e)}};return new e(t,r,n,"email",i)}}),define("type/label",["type/default"],function(e){return function(t,n){var r={id:"id",label:"name"},i={initializeSub:function(){},setValue:function(e){!e[this.options.label]||this.$el.text(e[this.options.label]),!e[this.options.id]||this.$el.data(this.options.id,e[this.options.id])},getValue:function(){var e={};return e[this.options.id]=this.$el.data(this.options.id),e[this.options.name]=this.$el.text(),e},needsValidation:function(){return!1},validate:function(){return!0}};return new e(t,r,n,"label",i)}}),define("validator/default",[],function(){return function(e,t,n,r){return{name:r,initialize:function(){this.$el=e,this.data=$.extend(t,this.$el.data(),n),this.updateData(),!this.initializeSub||this.initializeSub()},updateConstraint:function(e){this.data=$.extend({},this.data,e),this.updateData()},updateData:function(){$.each(this.data,function(e,t){this.$el.data(e,t)}.bind(this))}}}}),define("validator/min",["validator/default"],function(e){return function(t,n){var r={min:0},i=$.extend({},new e(t,r,n,"min"),{validate:function(){var e=this.$el.val();return Number(e)>=this.data.min}});return i.initialize(),i}}),define("validator/max",["validator/default"],function(e){return function(t,n){var r={max:999},i=$.extend({},new e(t,r,n,"max"),{validate:function(){var e=this.$el.val();return Number(e)<=this.data.max}});return i.initialize(),i}}),define("validator/minLength",["validator/default"],function(e){return function(t,n){var r={minLength:0},i=$.extend({},new e(t,r,n,"min-length"),{validate:function(){var e=this.$el.val();return e.length>=this.data.minLength}});return i.initialize(),i}}),define("validator/maxLength",["validator/default"],function(e){return function(t,n){var r={maxLength:999},i=$.extend({},new e(t,r,n,"max-length"),{validate:function(){var e=this.$el.val();return e.length<=this.data.maxLength}});return i.initialize(),i}}),define("validator/required",["validator/default"],function(e){return function(t,n){var r={},i=$.extend({},new e(t,r,n,"required"),{validate:function(){if(!!this.data.required){var e=this.$el.val();if("object"==typeof e){for(var t in e)if(this.validate(e[t]))return!0;return!1}return e.length>0&&""!==e.replace(/^\s+/g,"").replace(/\s+$/g,"")}return!0}});return i.initialize(),i}});